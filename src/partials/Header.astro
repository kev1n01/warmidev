---
import SelectLang from "@/components/SelectLang.astro";
import ThemeToogle from "@/components/ThemeToogle.astro";
import IconMenu from "@/icons/IconMenu.astro";
import IconX from "@/icons/IconX.astro";
---

<header
    class="sticky top-3 z-10 w-full rounded-xl border border-white/10 bg-black/25 backdrop-blur-3xl shadow-inner shadow-white/50"
>
    <div class="flex items-center justify-between p-3 px-4 sm:px-6 lg:px-10">
        <a href="/">
            <div
                class="font-buycat text-xl sm:text-3xl font-bold flex items-center justify-center"
            >
                <img
                    src="/src/assets/logo.png"
                    alt="Logo"
                    class="h-7 w-7 sm:w-8 sm:h-8 pb-1 sm:pb-[6px] object-contain"
                />

                <div class="flex items-center">ARMI</div>
            </div>
        </a>

        <!-- Desktop Navigation -->
        <nav
            class="hidden sm:hidden md:flex gap-5 text-gray-300 font-semibold text-sm sm:text-base"
            id="desktop-nav"
        >
            <a href="#about" class="hover:text-white transition-colors"
                >Nosotros</a
            >
            <a href="#sponsors" class="hover:text-white transition-colors"
                >Sponsors</a
            >
        </nav>

        <!-- Right side controls -->
        <div class="flex items-center gap-2 sm:gap-3">
            <!-- Language Selector -->
            <SelectLang />

            <ThemeToogle />

            <!-- Mobile Menu Button -->
            <button
                class="sm:flex md:hidden flex p-1.5 sm:p-2 bg-white/10 rounded-full transition-colors"
                id="menu-toggle"
                title="Cambiar de tema"
                aria-label="Toggle menu"
            >
                <IconMenu
                    className="w-5 h-5 sm:w-6 sm:h-6"
                    idName="menu-icon"
                />
                <IconX
                    className="w-5 h-5 sm:w-6 sm:h-6 hidden"
                    idName="close-icon"
                />
            </button>
        </div>
    </div>

    <!-- Mobile Menu Dropdown -->
    <div
        class="absolute top-full left-0 right-0 mt-1 hidden sm:hidden md:hidden text-sm sm:text-base"
        id="mobile-menu"
    >
        <div
            class="mx-4 rounded-xl border border-white/10 bg-black/80 backdrop-blur-3xl shadow-inner shadow-white/50"
        >
            <nav class="flex flex-col gap-2 p-4 text-gray-300 font-semibold">
                <a
                    href="#goals"
                    class="p-2 hover:bg-white/10 hover:text-white rounded-lg transition-colors"
                >
                    Objetivos
                </a>
                <a
                    href="#sponsors"
                    class="p-2 hover:bg-white/10 hover:text-white rounded-lg transition-colors"
                >
                    Sponsors
                </a>
            </nav>
        </div>
    </div>
</header>
<script>
    // Manejo del scroll
    const header = document.querySelector("#header");
    const handleScroll = () => {
        if (window.scrollY > 0) {
            header?.classList.add("bg-black/50");
            header?.classList.remove("bg-black/25");
        } else {
            header?.classList.add("bg-black/25");
            header?.classList.remove("bg-black/50");
        }
    };
    window.addEventListener("scroll", handleScroll);

    // Manejo del menú móvil
    const menuToggle = document.querySelector("#menu-toggle");
    const mobileMenu = document.querySelector("#mobile-menu");
    const menuIcon = document.querySelector("#menu-icon");
    const closeIcon = document.querySelector("#close-icon");

    menuToggle?.addEventListener("click", () => {
        mobileMenu?.classList.toggle("hidden");
        menuIcon?.classList.toggle("hidden");
        closeIcon?.classList.toggle("hidden");
    });

    // Ocultar elementos en la página /temas
    document.addEventListener("DOMContentLoaded", () => {
        if (window.location.pathname.startsWith("/temas")) {
            const nav = document.querySelector("#desktop-nav");
            const comenzarBtn = document.querySelector("#comenzar-btn");
            if (nav) nav.style.display = "none";
            comenzarBtn?.classList.add("hidden");
        }
    });

    // Cerrar menú móvil al hacer click en un enlace
    const mobileLinks = document.querySelectorAll("#mobile-menu a");
    mobileLinks.forEach((link) => {
        link.addEventListener("click", () => {
            mobileMenu?.classList.add("hidden");
            menuIcon?.classList.remove("hidden");
            closeIcon?.classList.add("hidden");
        });
    });
</script>
